<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>gprob note</title>
<!--Generated on Wed Oct 16 14:26:12 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<!--Document created on October 16, 2024.-->

<link rel="stylesheet" href="LaTeXML.css" type="text/css">
<link rel="stylesheet" href="ltx-article.css" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="stylesheet" href="my.css" type="text/css">
<script src="LaTeXML-maybeMathjax.js"></script>
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span class="ltx_text ltx_font_typewriter">gprob</span> note</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Sergey Fedorov
<br class="ltx_break"><em class="ltx_emph ltx_font_italic">Quantop, Niels Bohr Institute 
<br class="ltx_break">Copenhagen, Denmark</em>
</span></span>
</div>
<div class="ltx_dates">(October 16, 2024)</div>

<div id="p1" class="ltx_para">
<p class="ltx_p">Probabilistic programs define statistical models as compositions of primitive distributions conditioned on observations.
Inference of general conditional distributions is a hard task.
The computational overhead of general inference methods, such as Markov chain or Hamiltonian Monte-Carlo, can make it difficult for probabilistic programs to compete with problem-specific approaches.
For Gaussian random variables, however, this is not necessarily the case ‚Äî as conditional distributions can be found analytically, the overhead for their computation can be minimal.</p>
</div>
<div id="p2" class="ltx_para">
<p class="ltx_p">This note presents the background theory for <span class="ltx_text ltx_font_typewriter">gprob</span>, a probabilistic programming package that specializes to Gaussian random variables.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Distributions defined via linear maps.</h2>

<div id="S1.p1" class="ltx_para">
<p class="ltx_p">Any Gaussian probabilistic program¬†<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> can be expressed as a linear map of a number of independent identically distributed (iid) normal variables <math id="S1.p1.m1" class="ltx_Math" alttext="e_{i}" display="inline"><msub><mi>e</mi><mi>i</mi></msub></math> with zero mean and unit variance,</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1" class="ltx_Math" alttext="e_{i}\sim\mathcal{N}(0,1),\qquad i=1,\ldots,n." display="block"><mrow><mrow><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>‚àº</mo><mrow><mi class="ltx_font_mathcaligraphic">ùí©</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo rspace="2.167em">,</mo><mrow><mi>i</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><mi>n</mi></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">In <span class="ltx_text ltx_font_typewriter">gprob</span>, all random arrays are represented in this way ‚Äî as affine maps of latent variables. E.g., a random array named <math id="S1.p1.m2" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> indexed by a multi-dimensional index <math id="S1.p1.m3" class="ltx_Math" alttext="ijk\ldots" display="inline"><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></math> is represented as</p>
<table id="S1.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E2.m1" class="ltx_Math" alttext="x_{ijk\ldots}=\sum_{\lambda}e_{\lambda}a_{\lambda,ijk\ldots}+b_{ijk\ldots}," display="block"><mrow><mrow><msub><mi>x</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></msub><mo rspace="0.111em">=</mo><mrow><mrow><munder><mo movablelimits="false">‚àë</mo><mi>Œª</mi></munder><mrow><msub><mi>e</mi><mi>Œª</mi></msub><mo>‚Å¢</mo><msub><mi>a</mi><mrow><mi>Œª</mi><mo>,</mo><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></mrow></msub></mrow></mrow><mo>+</mo><msub><mi>b</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></msub></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S1.p1.m4" class="ltx_Math" alttext="\{e_{\lambda}\sim\mathcal{N}(0,1)\}" display="inline"><mrow><mo stretchy="false">{</mo><mrow><msub><mi>e</mi><mi>Œª</mi></msub><mo>‚àº</mo><mrow><mi class="ltx_font_mathcaligraphic">ùí©</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mrow></mrow><mo stretchy="false">}</mo></mrow></math>, <math id="S1.p1.m5" class="ltx_Math" alttext="\lambda=1,\ldots,n" display="inline"><mrow><mi>Œª</mi><mo>=</mo><mrow><mn>1</mn><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><mi>n</mi></mrow></mrow></math> is the set of latent univariate normal variables, and <math id="S1.p1.m6" class="ltx_Math" alttext="a" display="inline"><mi>a</mi></math> and <math id="S1.p1.m7" class="ltx_Math" alttext="b" display="inline"><mi>b</mi></math> are numerical arrays with real or complex coefficients. The mean of <math id="S1.p1.m8" class="ltx_Math" alttext="x_{ijk\ldots}" display="inline"><msub><mi>x</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></msub></math> equals <math id="S1.p1.m9" class="ltx_Math" alttext="b_{ijk\ldots}" display="inline"><msub><mi>b</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></msub></math>, and the covariance is</p>
<table id="S1.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E3.m1" class="ltx_Math" alttext="C_{ijk\ldots,rst\ldots}=\sum_{\lambda}a_{\lambda,ijk\ldots}a^{*}_{\lambda,rst%
\ldots}," display="block"><mrow><mrow><msub><mi>C</mi><mrow><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow><mo>,</mo><mrow><mi>r</mi><mo>‚Å¢</mo><mi>s</mi><mo>‚Å¢</mo><mi>t</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></mrow></msub><mo rspace="0.111em">=</mo><mrow><munder><mo movablelimits="false">‚àë</mo><mi>Œª</mi></munder><mrow><msub><mi>a</mi><mrow><mi>Œª</mi><mo>,</mo><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></mrow></msub><mo>‚Å¢</mo><msubsup><mi>a</mi><mrow><mi>Œª</mi><mo>,</mo><mrow><mi>r</mi><mo>‚Å¢</mo><mi>s</mi><mo>‚Å¢</mo><mi>t</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></mrow><mo>‚àó</mo></msubsup></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S1.p1.m10" class="ltx_Math" alttext="rst\ldots" display="inline"><mrow><mi>r</mi><mo>‚Å¢</mo><mi>s</mi><mo>‚Å¢</mo><mi>t</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></math> run over the same set of indices as <math id="S1.p1.m11" class="ltx_Math" alttext="ijk\ldots" display="inline"><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi><mo>‚Å¢</mo><mi>k</mi><mo>‚Å¢</mo><mi mathvariant="normal">‚Ä¶</mi></mrow></math> and <sup class="ltx_sup">‚àó</sup> denotes complex conjugation.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p class="ltx_p">New latent variables are allocated during calls to <span class="ltx_text ltx_font_typewriter">normal()</span>. For example, <span class="ltx_text ltx_font_typewriter">normal(0, 1)</span> produces one latent variable, and <span class="ltx_text ltx_font_typewriter">normal(size=sz)</span>, where <span class="ltx_text ltx_font_typewriter">sz</span> is integer, produces <span class="ltx_text ltx_font_typewriter">sz</span> new latent variables. A global inventory of all latent variables is maintained, but their joint distributions are only materialized within individual arrays. This has an effect on the memory footprint. Roughly speaking, if one random variable takes <math id="S1.p2.m1" class="ltx_Math" alttext="m" display="inline"><mi>m</mi></math> bytes, then two arrays of <math id="S1.p2.m2" class="ltx_Math" alttext="n" display="inline"><mi>n</mi></math> variables each will take <math id="S1.p2.m3" class="ltx_Math" alttext="m\times(2\times n^{2})" display="inline"><mrow><mi>m</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><mo stretchy="false">)</mo></mrow></mrow></math> bytes, and not <math id="S1.p2.m4" class="ltx_Math" alttext="m\times(2\times n)^{2}" display="inline"><mrow><mi>m</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow><mo stretchy="false">)</mo></mrow><mn>2</mn></msup></mrow></math> bytes.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Conditioning.</h2>

<div id="S2.p1" class="ltx_para">
<p class="ltx_p">In a probabilistic language that maintains a joint distribution over all latent variables, such as the one presented in Ref.¬†<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, conditioning is a statement that updates the latent distribution. One can think of the conditioning in this case as a post-selection to the realizations of the latent variables that ensures that all the conditions are fulfilled. In contrast, in <span class="ltx_text ltx_font_typewriter">gprob</span>, conditioning of <math id="S2.p1.m1" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> on <math id="S2.p1.m2" class="ltx_Math" alttext="y=0" display="inline"><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow></math> is an expression that produces a new random variable, whose latent space is the union of the latent spaces of <math id="S2.p1.m3" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> and <math id="S2.p1.m4" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math>.
In this case, one can think of the conditioning as creating a version <math id="S2.p1.m5" class="ltx_Math" alttext="x" display="inline"><mi>x</mi></math> that is feed-forward corrected based on the measurement of <math id="S2.p1.m6" class="ltx_Math" alttext="y" display="inline"><mi>y</mi></math>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p class="ltx_p">To show how the conditioning is implemented, we consider the one-dimensional real case. Any random variable can be transformed to this representation by flattening and, if the variable is complex, by separating its real and imaginary parts. Let the conditioned variable be <math id="S2.p2.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math>, the condition be <math id="S2.p2.m2" class="ltx_Math" alttext="\mathbf{y}=\mathbf{0}" display="inline"><mrow><mi>ùê≤</mi><mo>=</mo><mn>ùüé</mn></mrow></math>, and the result of conditioning be <math id="S2.p2.m3" class="ltx_Math" alttext="\mathbf{z}\equiv\mathbf{x}|(\mathbf{y}=\mathbf{0})" display="inline"><mrow><mi>ùê≥</mi><mo>‚â°</mo><mrow><mi>ùê±</mi><mo fence="false">|</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ùê≤</mi><mo>=</mo><mn>ùüé</mn></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></math>. All more general cases can be reduced to this: if a non-zero value of <math id="S2.p2.m4" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> was observed, this value can be subtracted from <math id="S2.p2.m5" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math>, and if there is more than one observation, they can be stacked together in one <math id="S2.p2.m6" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> vector.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p class="ltx_p">The variables <math id="S2.p3.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and <math id="S2.p3.m2" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> take values in <math id="S2.p3.m3" class="ltx_Math" alttext="\mathbb{R}^{d_{x}}" display="inline"><msup><mi>‚Ñù</mi><msub><mi>d</mi><mi>x</mi></msub></msup></math> and <math id="S2.p3.m4" class="ltx_Math" alttext="\mathbb{R}^{d_{y}}" display="inline"><msup><mi>‚Ñù</mi><msub><mi>d</mi><mi>y</mi></msub></msup></math>, and are represented by the maps of the same vector of latent variables <math id="S2.p3.m5" class="ltx_Math" alttext="\mathbf{e}=(e_{1},\ldots,e_{n})" display="inline"><mrow><mi>ùêû</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>e</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><msub><mi>e</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math>,</p>
<table id="S2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E4.m1" class="ltx_Math" alttext="\mathbf{x}=\mathbf{A}_{x}^{T}\mathbf{e}+\mathbf{b}_{x},\qquad\mathbf{y}=%
\mathbf{A}_{y}^{T}\mathbf{e}+\mathbf{b}_{y}," display="block"><mrow><mrow><mrow><mi>ùê±</mi><mo>=</mo><mrow><mrow><msubsup><mi>ùêÄ</mi><mi>x</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><mi>ùêû</mi></mrow><mo>+</mo><msub><mi>ùêõ</mi><mi>x</mi></msub></mrow></mrow><mo rspace="2.167em">,</mo><mrow><mi>ùê≤</mi><mo>=</mo><mrow><mrow><msubsup><mi>ùêÄ</mi><mi>y</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><mi>ùêû</mi></mrow><mo>+</mo><msub><mi>ùêõ</mi><mi>y</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S2.p3.m6" class="ltx_Math" alttext="\mathbf{A}_{x}" display="inline"><msub><mi>ùêÄ</mi><mi>x</mi></msub></math> and <math id="S2.p3.m7" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math> are, respectively, <math id="S2.p3.m8" class="ltx_Math" alttext="n\times d_{x}" display="inline"><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></math> and <math id="S2.p3.m9" class="ltx_Math" alttext="n\times d_{y}" display="inline"><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>d</mi><mi>y</mi></msub></mrow></math> matrices, and <math id="S2.p3.m10" class="ltx_Math" alttext="\mathbf{b}_{x}" display="inline"><msub><mi>ùêõ</mi><mi>x</mi></msub></math> and <math id="S2.p3.m11" class="ltx_Math" alttext="\mathbf{b}_{y}" display="inline"><msub><mi>ùêõ</mi><mi>y</mi></msub></math> are <math id="S2.p3.m12" class="ltx_Math" alttext="d_{x}" display="inline"><msub><mi>d</mi><mi>x</mi></msub></math> and <math id="S2.p3.m13" class="ltx_Math" alttext="d_{y}" display="inline"><msub><mi>d</mi><mi>y</mi></msub></math>-size mean vectors. The rank of the condition matrix, <math id="S2.p3.m14" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>, is assumed to be full and equal to <math id="S2.p3.m15" class="ltx_Math" alttext="d_{y}\leq n" display="inline"><mrow><msub><mi>d</mi><mi>y</mi></msub><mo>‚â§</mo><mi>n</mi></mrow></math>, which means that the conditions are neither incompatible nor tautological. If the rank of <math id="S2.p3.m16" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math> is less than <math id="S2.p3.m17" class="ltx_Math" alttext="d_{y}" display="inline"><msub><mi>d</mi><mi>y</mi></msub></math>, yet the conditions are compatible, some of them can be eliminated from <math id="S2.p3.m18" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p class="ltx_p">Conditioning splits the latent space into two orthogonal subspaces‚Äîone in which the allowed values of the latent variables are fully determined to yield the observed value of <math id="S2.p4.m1" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math>, and one in which the values of the latent variables are unconstrained.
The conditional mean is found by evaluating <math id="S2.p4.m2" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> at the value of the latent vector <math id="S2.p4.m3" class="ltx_Math" alttext="\tilde{\mathbf{e}}" display="inline"><mover accent="true"><mi>ùêû</mi><mo>~</mo></mover></math> from the first subspace, which satisfies</p>
<table id="S2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E5.m1" class="ltx_Math" alttext="\mathbf{A}^{T}_{y}\tilde{\mathbf{e}}+\mathbf{b}_{y}=0." display="block"><mrow><mrow><mrow><mrow><msubsup><mi>ùêÄ</mi><mi>y</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><mover accent="true"><mi>ùêû</mi><mo>~</mo></mover></mrow><mo>+</mo><msub><mi>ùêõ</mi><mi>y</mi></msub></mrow><mo>=</mo><mn>0</mn></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">This value can be formally found as</p>
<table id="S2.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E6.m1" class="ltx_Math" alttext="\tilde{\mathbf{e}}=-\left(\mathbf{A}^{+}_{y}\right)^{T}\mathbf{b}_{y}," display="block"><mrow><mrow><mover accent="true"><mi>ùêû</mi><mo>~</mo></mover><mo>=</mo><mrow><mo>‚àí</mo><mrow><msup><mrow><mo>(</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>)</mo></mrow><mi>T</mi></msup><mo>‚Å¢</mo><msub><mi>ùêõ</mi><mi>y</mi></msub></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S2.p4.m4" class="ltx_Math" alttext="\mathbf{A}_{y}^{+}" display="inline"><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup></math> is the Moore‚ÄìPenrose pseudoinverse of <math id="S2.p4.m5" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>. (As <math id="S2.p4.m6" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math> is normally not a square matrix, it does not have an inverse). To obtain <math id="S2.p4.m7" class="ltx_Math" alttext="\tilde{\mathbf{e}}" display="inline"><mover accent="true"><mi>ùêû</mi><mo>~</mo></mover></math> in practice, it is more convenient to directly solve the system of equations in Eq.¬†(<a href="#S2.E5" title="Equation 5 ‚Ä£ 2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) in the least square sense. The mean of the conditional variable <math id="S2.p4.m8" class="ltx_Math" alttext="\mathbf{z}" display="inline"><mi>ùê≥</mi></math>, <math id="S2.p4.m9" class="ltx_Math" alttext="\mathbf{b}_{z}" display="inline"><msub><mi>ùêõ</mi><mi>z</mi></msub></math>, is then given by</p>
<table id="S2.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E7.m1" class="ltx_Math" alttext="\mathbf{b}_{z}=\mathbf{b}_{x}-\mathbf{A}_{x}^{T}\left(\mathbf{A}^{+}_{y}\right%
)^{T}\mathbf{b}_{y}." display="block"><mrow><mrow><msub><mi>ùêõ</mi><mi>z</mi></msub><mo>=</mo><mrow><msub><mi>ùêõ</mi><mi>x</mi></msub><mo>‚àí</mo><mrow><msubsup><mi>ùêÄ</mi><mi>x</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><msup><mrow><mo>(</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>)</mo></mrow><mi>T</mi></msup><mo>‚Å¢</mo><msub><mi>ùêõ</mi><mi>y</mi></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p5" class="ltx_para">
<p class="ltx_p">The conditional map, <math id="S2.p5.m1" class="ltx_Math" alttext="\mathbf{A}_{z}" display="inline"><msub><mi>ùêÄ</mi><mi>z</mi></msub></math>, is found by left-multiplying <math id="S2.p5.m2" class="ltx_Math" alttext="\mathbf{A}_{x}" display="inline"><msub><mi>ùêÄ</mi><mi>x</mi></msub></math> by the projector on the latent subspace unaffected by the conditioning, i.e. the subspace orthogonal to the columns of the constraint matrix <math id="S2.p5.m3" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>. The operator that performs the desired projection is <math id="S2.p5.m4" class="ltx_Math" alttext="\mathbf{I}-\mathbf{A}_{y}\mathbf{A}_{y}^{+}" display="inline"><mrow><mi>ùêà</mi><mo>‚àí</mo><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>‚Å¢</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup></mrow></mrow></math>, where <math id="S2.p5.m5" class="ltx_Math" alttext="\mathbf{I}" display="inline"><mi>ùêà</mi></math> is the identity matrix, and the conditional map is</p>
<table id="S2.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E8.m1" class="ltx_Math" alttext="\mathbf{A}_{z}=\mathbf{A}_{x}-\mathbf{A}_{y}\mathbf{A}^{+}_{y}\mathbf{A}_{x}." display="block"><mrow><mrow><msub><mi>ùêÄ</mi><mi>z</mi></msub><mo>=</mo><mrow><msub><mi>ùêÄ</mi><mi>x</mi></msub><mo>‚àí</mo><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>‚Å¢</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S2.p6" class="ltx_para">
<p class="ltx_p">One can verify that the conditional mean and covariance that follow from Eqs.¬†(<a href="#S2.E7" title="Equation 7 ‚Ä£ 2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>-<a href="#S2.E8" title="Equation 8 ‚Ä£ 2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) agree with those obtained based on the momentum representation of <math id="S2.p6.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and <math id="S2.p6.m2" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> (given in Appendix A). To make this comparison, we can use the facts that the cross-covariance matrix between <math id="S2.p6.m3" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and <math id="S2.p6.m4" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> is</p>
<table id="S2.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E9.m1" class="ltx_Math" alttext="\mathbf{C}_{xy}=\mathbf{A}_{x}^{T}\mathbf{A}_{y}," display="block"><mrow><mrow><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub><mo>=</mo><mrow><msubsup><mi>ùêÄ</mi><mi>x</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>y</mi></msub></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">that <math id="S2.p6.m5" class="ltx_Math" alttext="\mathbf{P}=\mathbf{A}_{y}\mathbf{A}^{+}_{y}" display="inline"><mrow><mi>ùêè</mi><mo>=</mo><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>‚Å¢</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup></mrow></mrow></math> is an orthogonal projector satisfying <math id="S2.p6.m6" class="ltx_Math" alttext="\mathbf{P}^{2}=\mathbf{P}" display="inline"><mrow><msup><mi>ùêè</mi><mn>2</mn></msup><mo>=</mo><mi>ùêè</mi></mrow></math> and <math id="S2.p6.m7" class="ltx_Math" alttext="\mathbf{P}^{T}=\mathbf{P}" display="inline"><mrow><msup><mi>ùêè</mi><mi>T</mi></msup><mo>=</mo><mi>ùêè</mi></mrow></math>, and also that for a full-rank matrix <math id="S2.p6.m8" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math> the block <math id="S2.p6.m9" class="ltx_Math" alttext="\mathbf{C}_{yy}=\mathbf{A}^{T}_{y}\mathbf{A}_{y}" display="inline"><mrow><msub><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub><mo>=</mo><mrow><msubsup><mi>ùêÄ</mi><mi>y</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>y</mi></msub></mrow></mrow></math> is invertible, with its inverse being</p>
<table id="S2.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E10.m1" class="ltx_Math" alttext="\mathbf{C}_{yy}^{-1}=\mathbf{A}^{+}_{y}\left(\mathbf{A}^{+}_{y}\right)^{T}." display="block"><mrow><mrow><msubsup><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mo>=</mo><mrow><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>‚Å¢</mo><msup><mrow><mo>(</mo><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>)</mo></mrow><mi>T</mi></msup></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Causal conditioning of time series. Wiener filtering.</h2>

<div id="S3.p1" class="ltx_para">
<p class="ltx_p">Sec.¬†<a href="#S2" title="2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> described the conditioning of all elements of one random vector <math id="S3.p1.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> on all elements of another vector <math id="S3.p1.m2" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math>. There is also another, more specialized, problem that arises sometimes‚Äîthe conditioning of individual elements <math id="S3.p1.m3" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math>, for <math id="S3.p1.m4" class="ltx_math_unparsed" alttext="i=1,..,d_{x}" display="inline"><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mo lspace="0em" rspace="0.0835em">.</mo><mo lspace="0.0835em" rspace="0.167em">.</mo><mo>,</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></math>, on subsets <math id="S3.p1.m5" class="ltx_Math" alttext="\{y_{j}:\,j\leq s_{i}\}" display="inline"><mrow><mo stretchy="false">{</mo><msub><mi>y</mi><mi>j</mi></msub><mo lspace="0.278em" rspace="0.448em">:</mo><mrow><mi>j</mi><mo>‚â§</mo><msub><mi>s</mi><mi>i</mi></msub></mrow><mo stretchy="false">}</mo></mrow></math> for some non-decreasing set of integer indices <math id="S3.p1.m6" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi>s</mi><mi>i</mi></msub></math>. This problem appears, in particular, in the causal analysis of time series via Kalman and Wiener filtering, where the elements of <math id="S3.p1.m7" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and <math id="S3.p1.m8" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> correspond to a range of sequential moments in time. (For an introduction to filtering see, for example, Ref.¬†<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>). The time stamps on <math id="S3.p1.m9" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and <math id="S3.p1.m10" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> are non-decreasing, but not necessarily equally separated, and can also repeat. The task can be for each <math id="S3.p1.m11" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math> to find its distribution conditioned only on those observations <math id="S3.p1.m12" class="ltx_Math" alttext="\{y_{j}\}" display="inline"><mrow><mo stretchy="false">{</mo><msub><mi>y</mi><mi>j</mi></msub><mo stretchy="false">}</mo></mrow></math> that came before <math id="S3.p1.m13" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math>. We, therefore, call the corresponding problem ‚Äúcausal conditioning‚Äù.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p class="ltx_p">Causal conditioning can be performed trivially using the result of Sec.¬†<a href="#S2" title="2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> by iterating over the elements of <math id="S3.p2.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> and each time selecting an appropriate range from <math id="S3.p2.m2" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math>. This would be, roughly speaking, <math id="S3.p2.m3" class="ltx_Math" alttext="d_{x}" display="inline"><msub><mi>d</mi><mi>x</mi></msub></math> time more computationally expensive than the simple conditioning of all <math id="S3.p2.m4" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math> on all <math id="S3.p2.m5" class="ltx_Math" alttext="y_{j}" display="inline"><msub><mi>y</mi><mi>j</mi></msub></math>. Fortunately, there is an algorithm that allows to causally condition all elements of <math id="S3.p2.m6" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> in one go.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p class="ltx_p">To introduce this algorithm, we first note that in the case of regular conditioning both the conditional mean and map (given by Eq.¬†(<a href="#S2.E7" title="Equation 7 ‚Ä£ 2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>) and Eq.¬†(<a href="#S2.E8" title="Equation 8 ‚Ä£ 2 Conditioning. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>), respectively), could be expressed using a <math id="S3.p3.m1" class="ltx_Math" alttext="d_{y}\times d_{x}" display="inline"><mrow><msub><mi>d</mi><mi>y</mi></msub><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></math> matrix <math id="S3.p3.m2" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math>,</p>
<table id="S3.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E11.m1" class="ltx_Math" alttext="\mathbf{B}=\mathbf{A}^{+}_{y}\mathbf{A}_{x}" display="block"><mrow><mi>ùêÅ</mi><mo>=</mo><mrow><msubsup><mi>ùêÄ</mi><mi>y</mi><mo>+</mo></msubsup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">as</p>
<table id="S3.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E12.m1" class="ltx_Math" alttext="\mathbf{b}_{z}^{T}=\mathbf{b}_{x}^{T}-\mathbf{b}_{y}^{T}\mathbf{B},\qquad%
\mathbf{A}_{z}=\mathbf{A}_{x}-\mathbf{A}_{y}\mathbf{B}." display="block"><mrow><mrow><mrow><msubsup><mi>ùêõ</mi><mi>z</mi><mi>T</mi></msubsup><mo>=</mo><mrow><msubsup><mi>ùêõ</mi><mi>x</mi><mi>T</mi></msubsup><mo>‚àí</mo><mrow><msubsup><mi>ùêõ</mi><mi>y</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><mi>ùêÅ</mi></mrow></mrow></mrow><mo rspace="2.167em">,</mo><mrow><msub><mi>ùêÄ</mi><mi>z</mi></msub><mo>=</mo><mrow><msub><mi>ùêÄ</mi><mi>x</mi></msub><mo>‚àí</mo><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>‚Å¢</mo><mi>ùêÅ</mi></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">The <math id="S3.p3.m3" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>-th column of <math id="S3.p3.m4" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> consists of the coefficients that give the closest in Euclidean distance approximation of the <math id="S3.p3.m5" class="ltx_Math" alttext="i" display="inline"><mi>i</mi></math>-th column of <math id="S3.p3.m6" class="ltx_Math" alttext="\mathbf{A}_{x}" display="inline"><msub><mi>ùêÄ</mi><mi>x</mi></msub></math> via a linear combination of the columns of <math id="S3.p3.m7" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>.
From this point of view, it should be clear that for vectors whose components are indexed left to right, <math id="S3.p3.m8" class="ltx_Math" alttext="\mathbf{x}=(x_{1},\ldots,x_{d_{x}})" display="inline"><mrow><mi>ùê±</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><msub><mi>x</mi><msub><mi>d</mi><mi>x</mi></msub></msub><mo stretchy="false">)</mo></mrow></mrow></math> and <math id="S3.p3.m9" class="ltx_Math" alttext="\mathbf{y}=(y_{1},\ldots,y_{d_{y}})" display="inline"><mrow><mi>ùê≤</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><msub><mi>y</mi><msub><mi>d</mi><mi>y</mi></msub></msub><mo stretchy="false">)</mo></mrow></mrow></math>, a causal structure can be enforced in conditioning by constraining the closest-approximation matrix <math id="S3.p3.m10" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> to be upper-triangular,</p>
<table id="S3.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E13.m1" class="ltx_Math" alttext="\mathbf{B}=\begin{pmatrix}\beta_{11}&amp;\beta_{12}&amp;\cdots&amp;\beta_{1d_{x}}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
\beta_{s_{1}1}&amp;\beta_{s_{1}2}&amp;\cdots&amp;\beta_{s_{1}d_{x}}\\
0&amp;\beta_{(s_{1}+1)2}&amp;\cdots&amp;\beta_{(s_{1}+1)d_{x}}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
0&amp;\beta_{s_{2}2}&amp;\cdots&amp;\beta_{s_{2}d_{x}}\\
0&amp;0&amp;\cdots&amp;\beta_{(s_{2}+1)d_{x}}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots\\
0&amp;0&amp;\cdots&amp;\beta_{d_{y}d_{x}}\end{pmatrix}." display="block"><mrow><mrow><mi>ùêÅ</mi><mo>=</mo><mrow><mo>(</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><msub><mi>Œ≤</mi><mn>11</mn></msub></mtd><mtd><msub><mi>Œ≤</mi><mn>12</mn></msub></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><mn>1</mn><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ã±</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd></mtr><mtr><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>‚Å¢</mo><mn>1</mn></mrow></msub></mtd><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>‚Å¢</mo><mn>2</mn></mrow></msub></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>Œ≤</mi><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><mn>2</mn></mrow></msub></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ã±</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>‚Å¢</mo><mn>2</mn></mrow></msub></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><mrow><mo stretchy="false">(</mo><mrow><msub><mi>s</mi><mn>2</mn></msub><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr><mtr><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd><mtd><mi mathvariant="normal">‚ã±</mi></mtd><mtd><mi mathvariant="normal">‚ãÆ</mi></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mi mathvariant="normal">‚ãØ</mi></mtd><mtd><msub><mi>Œ≤</mi><mrow><msub><mi>d</mi><mi>y</mi></msub><mo>‚Å¢</mo><msub><mi>d</mi><mi>x</mi></msub></mrow></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">Here, the list of indices <math id="S3.p3.m11" class="ltx_Math" alttext="s_{i}" display="inline"><msub><mi>s</mi><mi>i</mi></msub></math> is a non-decreasing sequence of integers from the range <math id="S3.p3.m12" class="ltx_Math" alttext="[1,d_{y}]" display="inline"><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><msub><mi>d</mi><mi>y</mi></msub><mo stretchy="false">]</mo></mrow></math> that is tailored to the causal structure of the problem. For example, in causal Wiener filtering of a scalar random process <math id="S3.p3.m13" class="ltx_Math" alttext="x(t)" display="inline"><mrow><mi>x</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math> with a scalar noisy measurement <math id="S3.p3.m14" class="ltx_Math" alttext="y(t)" display="inline"><mrow><mi>y</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></mrow></math>, discretized as <math id="S3.p3.m15" class="ltx_Math" alttext="x_{i}" display="inline"><msub><mi>x</mi><mi>i</mi></msub></math> and <math id="S3.p3.m16" class="ltx_Math" alttext="y_{i}" display="inline"><msub><mi>y</mi><mi>i</mi></msub></math>, we could put <math id="S3.p3.m17" class="ltx_Math" alttext="s_{i}=i-1" display="inline"><mrow><msub><mi>s</mi><mi>i</mi></msub><mo>=</mo><mrow><mi>i</mi><mo>‚àí</mo><mn>1</mn></mrow></mrow></math> to use all observations before the time <math id="S3.p3.m18" class="ltx_Math" alttext="t_{i}" display="inline"><msub><mi>t</mi><mi>i</mi></msub></math> for the prediction of <math id="S3.p3.m19" class="ltx_Math" alttext="x(t_{i})" display="inline"><mrow><mi>x</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math>.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p class="ltx_p">What remains is to find a way of obtaining causally-constrained matrices <math id="S3.p4.m1" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math>. Towards this goal, we introduce the QR decomposition of <math id="S3.p4.m2" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math>,</p>
<table id="S3.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E14.m1" class="ltx_Math" alttext="\mathbf{A}_{y}=\mathbf{Q}\mathbf{R}," display="block"><mrow><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>=</mo><mi>ùêêùêë</mi></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.p4.m3" class="ltx_Math" alttext="\mathbf{Q}" display="inline"><mi>ùêê</mi></math> is a <math id="S3.p4.m4" class="ltx_Math" alttext="n\times d_{y}" display="inline"><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>d</mi><mi>y</mi></msub></mrow></math> matrix whose columns is an orthonormal set of vectors, and <math id="S3.p4.m5" class="ltx_Math" alttext="\mathbf{R}" display="inline"><mi>ùêë</mi></math> is a <math id="S3.p4.m6" class="ltx_Math" alttext="d_{y}\times d_{y}" display="inline"><mrow><msub><mi>d</mi><mi>y</mi></msub><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>d</mi><mi>y</mi></msub></mrow></math> non-degenerate upper triangular matrix. The left-multiplication of <math id="S3.p4.m7" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> by <math id="S3.p4.m8" class="ltx_Math" alttext="\mathbf{R}" display="inline"><mi>ùêë</mi></math> preserves the triangular structure (meaning that the elements of <math id="S3.p4.m9" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> that are zero in Eq.¬†(<a href="#S3.E13" title="Equation 13 ‚Ä£ 3 Causal conditioning of time series. Wiener filtering. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>) are also zero in the multiplication product), and, therefore, the least-square solution of the system of equations</p>
<table id="S3.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E15.m1" class="ltx_Math" alttext="\mathbf{A}_{y}\mathbf{B}=\mathbf{A}_{x}," display="block"><mrow><mrow><mrow><msub><mi>ùêÄ</mi><mi>y</mi></msub><mo>‚Å¢</mo><mi>ùêÅ</mi></mrow><mo>=</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">with the desired causal constraint on <math id="S3.p4.m10" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> can be expressed as</p>
<table id="S3.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E16.m1" class="ltx_Math" alttext="\mathbf{B}=\mathbf{R}^{-1}\mathcal{M}\left[\mathbf{Q}^{T}\mathbf{A}_{x}\right]," display="block"><mrow><mrow><mi>ùêÅ</mi><mo>=</mo><mrow><msup><mi>ùêë</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><msup><mi>ùêê</mi><mi>T</mi></msup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow><mo>]</mo></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="S3.p4.m11" class="ltx_Math" alttext="\mathcal{M}[\ldots]" display="inline"><mrow><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">[</mo><mi mathvariant="normal">‚Ä¶</mi><mo stretchy="false">]</mo></mrow></mrow></math> a masking operator that zeros for its argument <math id="S3.p4.m12" class="ltx_Math" alttext="\ldots" display="inline"><mi mathvariant="normal">‚Ä¶</mi></math> the matrix elements that are zero in Eq.¬†(<a href="#S3.E13" title="Equation 13 ‚Ä£ 3 Causal conditioning of time series. Wiener filtering. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">13</span></a>).
Finally, the causally conditioned mean and map are given by</p>
<table id="Ax2.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m1" class="ltx_Math" alttext="\displaystyle\mathbf{b}_{z}^{T}=\mathbf{b}_{x}^{T}-\mathbf{b}_{y}^{T}\mathbf{R%
}^{-1}\mathbf{Q}\,\mathcal{M}\left[\mathbf{Q}^{\dagger}\mathbf{A}_{x}\right]," display="inline"><mrow><mrow><msubsup><mi>ùêõ</mi><mi>z</mi><mi>T</mi></msubsup><mo>=</mo><mrow><msubsup><mi>ùêõ</mi><mi>x</mi><mi>T</mi></msubsup><mo>‚àí</mo><mrow><msubsup><mi>ùêõ</mi><mi>y</mi><mi>T</mi></msubsup><mo>‚Å¢</mo><msup><mi>ùêë</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi>ùêê</mi><mo lspace="0.170em">‚Å¢</mo><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><msup><mi>ùêê</mi><mo>‚Ä†</mo></msup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E17.m2" class="ltx_Math" alttext="\displaystyle\mathbf{A}_{z}=\mathbf{A}_{x}-\mathbf{Q}\,\mathcal{M}\left[%
\mathbf{Q}^{\dagger}\mathbf{A}_{x}\right]." display="inline"><mrow><mrow><msub><mi>ùêÄ</mi><mi>z</mi></msub><mo>=</mo><mrow><msub><mi>ùêÄ</mi><mi>x</mi></msub><mo>‚àí</mo><mrow><mi>ùêê</mi><mo lspace="0.170em">‚Å¢</mo><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><msup><mi>ùêê</mi><mo>‚Ä†</mo></msup><mo>‚Å¢</mo><msub><mi>ùêÄ</mi><mi>x</mi></msub></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p5" class="ltx_para">
<p class="ltx_p">A similar analysis can be performed when <math id="S3.p5.m1" class="ltx_Math" alttext="\mathbf{B}" display="inline"><mi>ùêÅ</mi></math> is generalized lower-triangular, which in the Wiener filtering theory corresponds to anti-causal filtering. The main difference in this case is that <math id="S3.p5.m2" class="ltx_Math" alttext="\mathbf{A}_{y}" display="inline"><msub><mi>ùêÄ</mi><mi>y</mi></msub></math> needs to be decomposed as <math id="S3.p5.m3" class="ltx_Math" alttext="\mathbf{Q}^{\prime}\mathbf{L}" display="inline"><mrow><msup><mi>ùêê</mi><mo>‚Ä≤</mo></msup><mo>‚Å¢</mo><mi>ùêã</mi></mrow></math>, where <math id="S3.p5.m4" class="ltx_Math" alttext="\mathbf{L}" display="inline"><mi>ùêã</mi></math> is lower-triangular.</p>
</div>
</section>
<section id="Ax1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix A: Gaussian distributions defined via moments.</h2>

<div id="Ax1.p1" class="ltx_para">
<p class="ltx_p">The probability density function of a <math id="Ax1.p1.m1" class="ltx_Math" alttext="d" display="inline"><mi>d</mi></math>-dimensional Gaussian random variable with the mean vector <math id="Ax1.p1.m2" class="ltx_Math" alttext="\mathbf{m}=(m_{1},\ldots,m_{d})" display="inline"><mrow><mi>ùê¶</mi><mo>=</mo><mrow><mo stretchy="false">(</mo><msub><mi>m</mi><mn>1</mn></msub><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><msub><mi>m</mi><mi>d</mi></msub><mo stretchy="false">)</mo></mrow></mrow></math> and covariance matrix <math id="Ax1.p1.m3" class="ltx_Math" alttext="\mathbf{C}" display="inline"><mi>ùêÇ</mi></math> to take the value <math id="Ax1.p1.m4" class="ltx_Math" alttext="\mathbf{x}\in\mathbb{R}^{d}" display="inline"><mrow><mi>ùê±</mi><mo>‚àà</mo><msup><mi>‚Ñù</mi><mi>d</mi></msup></mrow></math> is given by</p>
<table id="Ax1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax1.E1.m1" class="ltx_Math" alttext="p(\mathbf{x})=(2\pi)^{-d/2}\left(\mathrm{det}(\mathbf{C})\right)^{-1/2}\mathrm%
{exp}\left(-\frac{1}{2}(\mathbf{x}-\mathbf{m})^{T}\mathbf{C}^{-1}(\mathbf{x}-%
\mathbf{m})\right)," display="block"><mrow><mrow><mrow><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><msup><mrow><mo stretchy="false">(</mo><mrow><mn>2</mn><mo>‚Å¢</mo><mi>œÄ</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mo>‚àí</mo><mrow><mi>d</mi><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>‚Å¢</mo><msup><mrow><mo>(</mo><mrow><mi>det</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùêÇ</mi><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow><mrow><mo>‚àí</mo><mrow><mn>1</mn><mo>/</mo><mn>2</mn></mrow></mrow></msup><mo>‚Å¢</mo><mi>exp</mi><mo>‚Å¢</mo><mrow><mo>(</mo><mrow><mo>‚àí</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><msup><mrow><mo stretchy="false">(</mo><mrow><mi>ùê±</mi><mo>‚àí</mo><mi>ùê¶</mi></mrow><mo stretchy="false">)</mo></mrow><mi>T</mi></msup><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mi>ùê±</mi><mo>‚àí</mo><mi>ùê¶</mi></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where <math id="Ax1.p1.m5" class="ltx_Math" alttext="\mathbf{C}^{-1}" display="inline"><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></math> is the inverse of the covariance. If <math id="Ax1.p1.m6" class="ltx_Math" alttext="\mathbf{C}" display="inline"><mi>ùêÇ</mi></math> is degenerate and thus non-invertible, the possible realizations of the random variable do not cover the whole space <math id="Ax1.p1.m7" class="ltx_Math" alttext="\mathbb{R}^{d}" display="inline"><msup><mi>‚Ñù</mi><mi>d</mi></msup></math>. Our convention when defining the probability density function for such variables is to assign <math id="Ax1.p1.m8" class="ltx_Math" alttext="p(\mathbf{x})=0" display="inline"><mrow><mrow><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mn>0</mn></mrow></math> to impossible samples, and, when dealing with possible samples, to use the Moore‚ÄìPenrose pseudoinverse <math id="Ax1.p1.m9" class="ltx_Math" alttext="\mathbf{C}^{+}" display="inline"><msup><mi>ùêÇ</mi><mo>+</mo></msup></math> instead of <math id="Ax1.p1.m10" class="ltx_Math" alttext="\mathbf{C}^{-1}" display="inline"><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></math> and the determinant of the non-degenerate projection of <math id="Ax1.p1.m11" class="ltx_Math" alttext="\mathbf{C}" display="inline"><mi>ùêÇ</mi></math> instead of <math id="Ax1.p1.m12" class="ltx_Math" alttext="\mathrm{det}(\mathbf{C})" display="inline"><mrow><mi>det</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùêÇ</mi><mo stretchy="false">)</mo></mrow></mrow></math> in Eq.¬†(<a href="#Ax1.E1" title="Equation A1 ‚Ä£ Appendix A: Gaussian distributions defined via moments. ‚Ä£ gprob note" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A1</span></a>). This is consistent with the way degenerate distributions are handled in <span class="ltx_text ltx_font_typewriter">scipy.stats</span>¬†<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="Ax1.p2" class="ltx_para">
<p class="ltx_p">If the random variable consists of two stacked vectors, <math id="Ax1.p2.m1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> with the dimension <math id="Ax1.p2.m2" class="ltx_Math" alttext="d_{x}" display="inline"><msub><mi>d</mi><mi>x</mi></msub></math>, and <math id="Ax1.p2.m3" class="ltx_Math" alttext="\mathbf{y}" display="inline"><mi>ùê≤</mi></math> with the dimension <math id="Ax1.p2.m4" class="ltx_Math" alttext="d_{y}" display="inline"><msub><mi>d</mi><mi>y</mi></msub></math>, and <math id="Ax1.p2.m5" class="ltx_Math" alttext="\mathbf{C}" display="inline"><mi>ùêÇ</mi></math> is their joint covariance matrix expressed in the block form as,</p>
<table id="Ax1.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax1.E2.m1" class="ltx_Math" alttext="\mathbf{C}=\begin{pmatrix}\mathbf{C}_{xx}&amp;\mathbf{C}_{xy}\\
\mathbf{C}_{yy}&amp;\mathbf{C}_{yy}\end{pmatrix}," display="block"><mrow><mrow><mi>ùêÇ</mi><mo>=</mo><mrow><mo>(</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>x</mi></mrow></msub></mtd><mtd><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub></mtd></mtr><mtr><mtd><msub><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub></mtd><mtd><msub><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub></mtd></mtr></mtable><mo>)</mo></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">the conditional probability density of <math id="Ax1.p2.m6" class="ltx_Math" alttext="\mathbf{x}" display="inline"><mi>ùê±</mi></math> given <math id="Ax1.p2.m7" class="ltx_Math" alttext="\mathbf{y}=\tilde{\mathbf{y}}" display="inline"><mrow><mi>ùê≤</mi><mo>=</mo><mover accent="true"><mi>ùê≤</mi><mo>~</mo></mover></mrow></math> is Gaussian with the mean and covariance given by</p>
<table id="Ax2.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ax1.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ax1.E3.m1" class="ltx_Math" alttext="\displaystyle\mathbf{m}_{\mathrm{c}}=\mathbf{m}_{x}+\mathbf{C}_{xy}\mathbf{C}^%
{-1}_{yy}(\tilde{\mathbf{y}}-\mathbf{m}_{y})," display="inline"><mrow><mrow><msub><mi>ùê¶</mi><mi mathvariant="normal">c</mi></msub><mo>=</mo><mrow><msub><mi>ùê¶</mi><mi>x</mi></msub><mo>+</mo><mrow><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub><mo>‚Å¢</mo><msubsup><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mover accent="true"><mi>ùê≤</mi><mo>~</mo></mover><mo>‚àí</mo><msub><mi>ùê¶</mi><mi>y</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A3)</span></td>
</tr></tbody>
<tbody id="Ax1.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ax1.E4.m1" class="ltx_Math" alttext="\displaystyle\mathbf{C}_{\mathrm{c}}=\mathbf{C}_{xx}-\mathbf{C}_{xy}\mathbf{C}%
^{-1}_{yy}\mathbf{C}_{yx}." display="inline"><mrow><mrow><msub><mi>ùêÇ</mi><mi mathvariant="normal">c</mi></msub><mo>=</mo><mrow><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>x</mi></mrow></msub><mo>‚àí</mo><mrow><msub><mi>ùêÇ</mi><mrow><mi>x</mi><mo>‚Å¢</mo><mi>y</mi></mrow></msub><mo>‚Å¢</mo><msubsup><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>y</mi></mrow><mrow><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mo>‚Å¢</mo><msub><mi>ùêÇ</mi><mrow><mi>y</mi><mo>‚Å¢</mo><mi>x</mi></mrow></msub></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(A4)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="Ax2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">Appendix B: Parametric derivatives and Fisher information.</h2>

<div id="Ax2.p1" class="ltx_para">
<p class="ltx_p">A number of information-theoretic properties of distributions whose mean and covariance depend on some parameters <math id="Ax2.p1.m1" class="ltx_Math" alttext="\mathbf{\theta}" display="inline"><mi>Œ∏</mi></math> are expressed via the logarithm of the probability density and its derivatives. For non-degenerate Gaussian distributions, they are given, respectively, by</p>
<table id="Ax2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax2.E1.m1" class="ltx_Math" alttext="\mathrm{ln}\,p(\mathbf{x})=-\frac{1}{2}\Delta\mathbf{x}^{T}\mathbf{C}^{-1}%
\Delta\mathbf{x}-\frac{1}{2}\mathrm{ln}\,\mathrm{det}(\mathbf{C})," display="block"><mrow><mrow><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow><mo>=</mo><mrow><mrow><mo>‚àí</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><msup><mi>ùê±</mi><mi>T</mi></msup><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi></mrow></mrow><mo>‚àí</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>det</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùêÇ</mi><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and</p>
<table id="Ax2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax2.E2.m1" class="ltx_Math" alttext="\frac{\partial\mathrm{ln}\,p(\mathbf{x})}{\partial\theta_{i}}=\frac{\partial%
\mathbf{m}^{T}}{\partial\theta_{i}}\mathbf{C}^{-1}\Delta\mathbf{x}+\frac{1}{2}%
\Delta\mathbf{x}^{T}\mathbf{C}^{-1}\frac{\partial\mathbf{C}}{\partial\theta_{i%
}}\mathbf{C}^{-1}\Delta\mathbf{x}-\frac{1}{2}\mathrm{Tr}\left[\mathbf{C}^{-1}%
\frac{\partial\mathbf{C}}{\partial\theta_{i}}\right]," display="block"><mrow><mrow><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>=</mo><mrow><mrow><mrow><mfrac><mrow><mo rspace="0em">‚àÇ</mo><msup><mi>ùê¶</mi><mi>T</mi></msup></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><msup><mi>ùê±</mi><mi>T</mi></msup><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi></mrow></mrow><mo>‚àí</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><mi>Tr</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">where</p>
<table id="Ax2.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax2.E3.m1" class="ltx_Math" alttext="\Delta\mathbf{x}=\mathbf{x}-\mathbf{m}." display="block"><mrow><mrow><mrow><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi></mrow><mo>=</mo><mrow><mi>ùê±</mi><mo>‚àí</mo><mi>ùê¶</mi></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">The expression for the derivatives was obtained using <math id="Ax2.p1.m2" class="ltx_Math" alttext="\partial\mathbf{C}^{-1}/\partial\theta=-\mathbf{C}^{-1}(\partial\mathbf{C}/%
\partial\theta)\mathbf{C}^{-1}" display="inline"><mrow><mrow><mo rspace="0em">‚àÇ</mo><mrow><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>/</mo><mrow><mo lspace="0em" rspace="0em">‚àÇ</mo><mi>Œ∏</mi></mrow></mrow></mrow><mo>=</mo><mrow><mo>‚àí</mo><mrow><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mrow><mo lspace="0em" rspace="0em">‚àÇ</mo><mrow><mi>ùêÇ</mi><mo>/</mo><mrow><mo lspace="0em" rspace="0em">‚àÇ</mo><mi>Œ∏</mi></mrow></mrow></mrow><mo stretchy="false">)</mo></mrow><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow></mrow></mrow></math>, and the fact that the matrix determinant equals the product of the eigenvalues.
The components of the Fisher information matrix <math id="Ax2.p1.m3" class="ltx_Math" alttext="F_{ij}" display="inline"><msub><mi>F</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi></mrow></msub></math> are given by (e.g.¬†<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>)</p>
<table id="Ax2.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax2.E4.m1" class="ltx_Math" alttext="F_{ij}=\frac{\partial\mathbf{m}^{T}}{\partial\theta_{i}}\mathbf{C}^{-1}\frac{%
\partial\mathbf{m}}{\partial\theta_{j}}+\frac{1}{2}\mathrm{Tr}\left[\mathbf{C}%
^{-1}\frac{\partial\mathbf{C}}{\partial\theta_{i}}\mathbf{C}^{-1}\frac{%
\partial\mathbf{C}}{\partial\theta_{j}}\right]," display="block"><mrow><mrow><msub><mi>F</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mrow><mfrac><mrow><mo rspace="0em">‚àÇ</mo><msup><mi>ùê¶</mi><mi>T</mi></msup></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùê¶</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mfrac></mrow><mo>+</mo><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>‚Å¢</mo><mi>Tr</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mfrac></mrow><mo>]</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">and related to the log probability density as</p>
<table id="Ax2.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="Ax2.E5.m1" class="ltx_Math" alttext="F_{ij}=\left\langle\frac{\partial\mathrm{ln}\,p(\mathbf{x})}{\partial\theta_{i%
}}\frac{\partial\mathrm{ln}\,p(\mathbf{x})}{\partial\theta_{j}}\right\rangle=-%
\left\langle\frac{\partial^{2}\mathrm{ln}\,p(\mathbf{x})}{\partial\theta_{i}%
\partial\theta_{j}}\right\rangle." display="block"><mrow><mrow><msub><mi>F</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi></mrow></msub><mo>=</mo><mrow><mo>‚ü®</mo><mrow><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac><mo>‚Å¢</mo><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mfrac></mrow><mo>‚ü©</mo></mrow><mo>=</mo><mrow><mo>‚àí</mo><mrow><mo>‚ü®</mo><mfrac><mrow><msup><mo>‚àÇ</mo><mn>2</mn></msup><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mo rspace="0em">‚àÇ</mo><mrow><msub><mi>Œ∏</mi><mi>i</mi></msub><mo lspace="0em">‚Å¢</mo><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mrow></mrow></mfrac><mo>‚ü©</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p">For completeness, here is also the expression for the second derivatives of the log probability density,</p>
<table id="Ax2.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="Ax2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="Ax2.Ex1.m1" class="ltx_Math" alttext="\displaystyle\frac{\partial^{2}\mathrm{ln}\,p(\mathbf{x})}{\partial\theta_{i}%
\partial\theta_{j}}=" display="inline"><mrow><mstyle displaystyle="true"><mfrac><mrow><msup><mo>‚àÇ</mo><mn>2</mn></msup><mrow><mi>ln</mi><mo lspace="0.170em">‚Å¢</mo><mi>p</mi><mo>‚Å¢</mo><mrow><mo stretchy="false">(</mo><mi>ùê±</mi><mo stretchy="false">)</mo></mrow></mrow></mrow><mrow><mo rspace="0em">‚àÇ</mo><mrow><msub><mi>Œ∏</mi><mi>i</mi></msub><mo lspace="0em">‚Å¢</mo><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mrow></mrow></mfrac></mstyle><mo>=</mo><mi></mi></mrow></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ax2.Ex1.m2" class="ltx_Math" alttext="\displaystyle-F_{ij}+\frac{\partial^{2}\mathbf{m}^{T}}{\partial\theta_{i}%
\partial\theta_{j}}\mathbf{C}^{-1}\Delta\mathbf{x}" display="inline"><mrow><mrow><mo>‚àí</mo><msub><mi>F</mi><mrow><mi>i</mi><mo>‚Å¢</mo><mi>j</mi></mrow></msub></mrow><mo>+</mo><mrow><mstyle displaystyle="true"><mfrac><mrow><msup><mo>‚àÇ</mo><mn>2</mn></msup><msup><mi>ùê¶</mi><mi>T</mi></msup></mrow><mrow><mo rspace="0em">‚àÇ</mo><mrow><msub><mi>Œ∏</mi><mi>i</mi></msub><mo lspace="0em">‚Å¢</mo><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mrow></mrow></mfrac></mstyle><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi></mrow></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="Ax2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="Ax2.E6.m1" class="ltx_Math" alttext="\displaystyle+\mathrm{Tr}\left[\left(\frac{1}{2}\mathbf{C}^{-1}\frac{\partial^%
{2}\mathbf{C}}{\partial\theta_{i}\partial\theta_{j}}\mathbf{C}^{-1}+\mathbf{C}%
^{-1}\frac{\partial\mathbf{C}}{\partial\theta_{i}}\frac{\partial\mathbf{C}^{-1%
}}{\partial\theta_{j}}\right)\left(\Delta\mathbf{x}\Delta\mathbf{x}^{T}-%
\mathbf{C}\right)\right]." display="inline"><mrow><mrow><mo>+</mo><mrow><mi>Tr</mi><mo>‚Å¢</mo><mrow><mo>[</mo><mrow><mrow><mo>(</mo><mrow><mrow><mstyle displaystyle="true"><mfrac><mn>1</mn><mn>2</mn></mfrac></mstyle><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mstyle displaystyle="true"><mfrac><mrow><msup><mo>‚àÇ</mo><mn>2</mn></msup><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><mrow><msub><mi>Œ∏</mi><mi>i</mi></msub><mo lspace="0em">‚Å¢</mo><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mrow></mrow></mfrac></mstyle><mo>‚Å¢</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><mo>+</mo><mrow><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup><mo>‚Å¢</mo><mstyle displaystyle="true"><mfrac><mrow><mo rspace="0em">‚àÇ</mo><mi>ùêÇ</mi></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>i</mi></msub></mrow></mfrac></mstyle><mo>‚Å¢</mo><mstyle displaystyle="true"><mfrac><mrow><mo rspace="0em">‚àÇ</mo><msup><mi>ùêÇ</mi><mrow><mo>‚àí</mo><mn>1</mn></mrow></msup></mrow><mrow><mo rspace="0em">‚àÇ</mo><msub><mi>Œ∏</mi><mi>j</mi></msub></mrow></mfrac></mstyle></mrow></mrow><mo>)</mo></mrow><mo>‚Å¢</mo><mrow><mo>(</mo><mrow><mrow><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><mi>ùê±</mi><mo>‚Å¢</mo><mi mathvariant="normal">Œî</mi><mo>‚Å¢</mo><msup><mi>ùê±</mi><mi>T</mi></msup></mrow><mo>‚àí</mo><mi>ùêÇ</mi></mrow><mo>)</mo></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo lspace="0em">.</mo></mrow></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(B6)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
      
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
D.¬†Stein and S.¬†Staton, ‚ÄúCompositional Semantics for Probabilistic
Programs with Exact Conditioning,‚Äù in <em class="ltx_emph ltx_font_italic">2021 36th Annual
ACM/IEEE Symposium on Logic in Computer Science (LICS)</em>, Jun.
2021, pp. 1‚Äì13. <a href="https://ieeexplore.ieee.org/document/9470552" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://ieeexplore.ieee.org/document/9470552</a>

</span>
</li>
      
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
R.¬†G. Brown, <em class="ltx_emph ltx_font_italic">Introduction to Random Signal Analysis and Kalman
Filtering</em>.¬†¬†¬†Wiley, 1983.

</span>
</li>
      
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Scipy reference
<a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.multivariate_normal.html" title="" class="ltx_ref ltx_href ltx_font_typewriter">scipy.stats.multivariate_normal</a>.

</span>
</li>
      
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Y.¬†Akimoto, Y.¬†Nagata, I.¬†Ono, and S.¬†Kobayashi, ‚ÄúTheoretical foundation for
CMA-ES from information geometric perspective,‚Äù Jun. 2012. <a href="http://arxiv.org/abs/1206.0730" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1206.0730</a>

</span>
</li>
    
</ul>
</section>
</article>
</div>

</div>
</body>
</html>
